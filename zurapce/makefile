#===============================================================================
# zurapce library makefile
#===============================================================================

.PHONY: all clean

#=======================================
# プロジェクト設定
#=======================================
include ../project.mak

#=======================================
# サフィックスルールを無視
#=======================================
.SUFFIXES:

#=======================================
# 生成コマンド・オプション
#=======================================
CC := pcc33
CFLAGS := -c -g -gp=0x0 -near -O2 -Wall
AS := pcc33
ASFLAGS := -c -g -gp=0x0 -near

LIB := lib33
CPP := cpp

#=======================================
# 構成ファイル・生成ファイル
#=======================================
TARGET := zurapce.lib
SOURCES := $(wildcard *.c)
DEPENDS := $(patsubst %.c,%.depend,$(SOURCES))
OBJECTS := $(patsubst %.c,%.o,$(SOURCES))

#=======================================
# 依存関係
#=======================================
all : $(TARGET)

$(TARGET) : $(OBJECTS)
	$(LIB) $@ $^

%.o : %.c
	$(CC) $(CFLAGS) $<

#=======================================
# 自動依存関係生成
#=======================================
%.depend : %.c
	$(CPP) -MM -I$(PIECE_INC_DIR) $< > $@

-include $(DEPENDS)

#=======================================
# クリーンアップ
#=======================================
clean :
	del $(TARGET)
	del *.o
	del *.depend

